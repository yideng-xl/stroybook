# CONSENSUS: MVP1 - 幼儿绘本网站 (纯前端版)

## 1. 需求概述 (Requirements)
构建一个响应式幼儿绘本 Web 应用，用户可以在 PC、Pad 和手机上浏览和阅读绘本。绘本数据（图片、文本）存储在本地文件系统中，应用需支持中英文切换、风格切换以及不同设备上的特定阅读体验。

## 2. 核心功能与验收标准 (Acceptance Criteria)

### 2.1 绘本列表 (首页)
- **功能**: 展示所有绘本的封面（取默认风格的第一页图片）和标题。
- **查询**: 
    - 顶部搜索栏：支持按**故事名称**模糊搜索。
    - 风格筛选：下拉选择风格（如“迪士尼”、“黏土动画”），筛选出包含该风格的故事。
- **验收标准**:
    - 页面加载时自动读取 `story-manifest.json` 渲染列表。
    - 能够正确显示中文/英文标题。
    - 响应式布局：PC 端网格排列，Mobile 端单列/双列排列。

### 2.2 绘本阅读 (详情页)
- **功能**: 展示绘本内容，包括图片和对应的文本。
- **交互**:
    - **PC / Pad**: 使用仿真翻页效果 (Flipbook)，支持鼠标拖拽或点击翻页。
    - **Mobile**: 使用上下滑动效果 (Vertical Scroll)，适合单手操作。
    - **风格切换**: 页面内提供下拉菜单，切换当前故事的不同风格（重新加载对应的图片集）。
    - **语言切换**: 支持三种模式切换：仅中文、仅英文、中英双语对照。
- **验收标准**:
    - PC 上翻页流畅，无卡顿。
    - 手机上滑动顺滑，图片自适应屏幕宽度。
    - 切换风格时，当前页码保持不变（如果可能），或重置到首页。
    - 切换语言模式即时生效，双语模式下排版应清晰。

### 2.3 数据管理
- **架构**: 纯前端应用，无后端数据库。
- **动态性**: 支持随时向 `stories` 文件夹添加新故事。
- **操作流程**: 添加文件 -> 运行 `npm run scan` (更新索引) -> 刷新网页 (无需重启 Web 服务或重新 Build)。

## 3. 技术规范 (Technical Specifications)

### 3.1 技术栈
- **核心框架**: React 18 + TypeScript。
- **构建工具**: Vite。
- **样式**: Tailwind CSS。
- **路由**: React Router v6。
- **状态管理**: React Context (管理全局设置，如语言偏好)。
- **关键库**:
    - `react-pageflip` (PC/Pad 翻页)。
    - `framer-motion` (可选，用于移动端平滑过渡动画)。

### 3.2 目录结构约定
```
project_root/
├── stories/                  # 数据源 (不包含在 git 代码库中，或作为资源子模块)
│   ├── 灰姑娘/
│   │   ├── story.json        # 故事元数据
│   │   ├── 迪士尼/           # 风格 A
│   │   │   ├── page-1.png
│   │   │   └── imagePrompt.json
│   │   └── 黏土动画/         # 风格 B
└── web/                      # 前端工程
    ├── public/
    │   └── story-manifest.json # 自动生成的索引文件
    ├── src/
    └── scripts/
        └── scan-stories.js   # 索引生成脚本
```

### 3.3 数据加载逻辑
- 前端通过 HTTP 请求 `/story-manifest.json` 获取目录。
- 图片路径约定：在开发环境指向 `/@fs/.../stories/...`，在生产环境指向 `/stories/...`（需配置构建脚本将 stories 拷贝至 dist 或配置 web server 别名）。

## 4. 交付物 (Deliverables)
1.  **源代码**: `web/` 目录下的完整工程。
2.  **工具脚本**: `web/scripts/scan-stories.js`。
3.  **文档**: 操作手册（如何添加新故事、如何运行）。

## 5. 风险与约束
- **浏览器安全限制**: 本地直接打开 HTML (`file://`) 可能无法加载资源，必须使用 Web Server (如 `npx serve` 或 Vite preview)。
- **大图性能**: 需注意图片大小，MVP1 暂不做服务端图片压缩，依赖源文件质量。
